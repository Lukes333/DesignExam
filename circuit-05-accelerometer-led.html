<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Circuit 05: Accelerometer (GY-61) + LED - Arduino Exam Reference</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Circuit 05: Accelerometer (GY-61) + LED</h1>
        <p class="subtitle">3-Axis Motion Detection with G-Force Conversion</p>
    </header>

    <nav class="quick-links">
        <a href="index.html" class="btn-primary">‚Üê Back to Home</a>
        <a href="quick-reference.html" class="btn-primary">Quick Reference</a>
        <a href="circuit-04-force-sensor-led.html" class="btn">‚Üê Previous</a>
        <a href="circuit-06-pot-servo.html" class="btn">Next Circuit ‚Üí</a>
    </nav>

    <main>
        <div class="circuit-hero">
            <div class="circuit-header">
                <h2 style="margin: 0; border: none;">GY-61 Accelerometer + LED Alert</h2>
                <span class="badge badge-critical">CRITICAL - WEEK 10</span>
            </div>
            <p style="margin-top: 1em;"><strong>Function:</strong> Measure 3-axis acceleration (X, Y, Z). LED turns ON when motion exceeds ¬±1.5g on any axis. Uses Serial Plotter for visualization.</p>

            <div class="circuit-meta">
                <div class="meta-item"><span class="meta-label">Probability:</span> <span class="meta-value">90%+</span></div>
                <div class="meta-item"><span class="meta-label">Difficulty:</span> <span class="meta-value">Medium</span></div>
                <div class="meta-item"><span class="meta-label">Key Concepts:</span> <span class="meta-value">Multi-Axis Input, G-Force Formula, abs(), Serial Plotter</span></div>
            </div>
        </div>

        <div class="content-section">
            <h2>Why This Circuit is Critical</h2>
            <ul>
                <li><strong>Multi-Axis Sensors:</strong> Tests reading and processing 3 analog inputs simultaneously</li>
                <li><strong>Formula Application:</strong> Converting analog values to real-world units (g-forces)</li>
                <li><strong>Serial Plotter:</strong> Visualizing data graphically - important Arduino tool</li>
                <li><strong>abs() Function:</strong> Absolute value for bidirectional threshold checking</li>
                <li><strong>Week 10 Content:</strong> Final circuit from your 5 worked examples</li>
                <li><strong>Real Applications:</strong> Smartphones, fitness trackers, airbag triggers, drones</li>
            </ul>
        </div>

        <div class="content-section">
            <h2>Components Required</h2>
            <table>
                <thead><tr><th>Component</th><th>Qty</th><th>Notes</th></tr></thead>
                <tbody>
                    <tr><td>Arduino Uno</td><td>1</td><td>Microcontroller</td></tr>
                    <tr><td>GY-61 Accelerometer Module</td><td>1</td><td>ADXL335 3-axis analog accelerometer</td></tr>
                    <tr><td>LED</td><td>1</td><td>Motion alert indicator</td></tr>
                    <tr><td>220Œ© Resistor</td><td>1</td><td>LED current limiter</td></tr>
                    <tr><td>Jumper Wires</td><td>8</td><td>Connections</td></tr>
                    <tr><td>Breadboard</td><td>1</td><td>Assembly</td></tr>
                </tbody>
            </table>
        </div>

        <div class="content-section">
            <h2>Detailed Circuit Connections</h2>

            <div class="connections-list">
                <div class="component">
                    <span class="component-name">GY-61 Accelerometer Module (ADXL335):</span>
                    <div class="connection">VCC ‚Üí Arduino 5V (module power)</div>
                    <div class="connection">GND ‚Üí Arduino GND (ground reference)</div>
                    <div class="connection">X (X-axis output) ‚Üí Arduino Analog A3</div>
                    <div class="connection">Y (Y-axis output) ‚Üí Arduino Analog A2</div>
                    <div class="connection">Z (Z-axis output) ‚Üí Arduino Analog A1</div>
                </div>

                <div class="component">
                    <span class="component-name">LED:</span>
                    <div class="connection">Anode (+ long leg) ‚Üí 220Œ© Resistor ‚Üí Arduino Digital Pin 7</div>
                    <div class="connection">Cathode (- short leg) ‚Üí Arduino GND</div>
                </div>
            </div>

            <div class="info-box">
                <div class="box-title">GY-61 Accelerometer Explanation</div>
                <p><strong>What it measures:</strong> Acceleration forces in 3 dimensions (X, Y, Z)</p>
                <ul>
                    <li><strong>At rest (no motion):</strong> Measures ~1g in Z-axis (Earth's gravity), ~0g in X and Y</li>
                    <li><strong>Moving:</strong> Additional acceleration shows up on respective axis</li>
                    <li><strong>Range:</strong> ¬±3g typical (can measure up to 3√ó Earth's gravity)</li>
                    <li><strong>Output:</strong> Analog voltage proportional to acceleration (1.65V = 0g, changes ¬±300mV per g)</li>
                </ul>
            </div>

            <div class="pin-note">
                <strong>Pin Notes:</strong>
                <ul>
                    <li><strong>Pins A1, A2, A3:</strong> Any 3 analog pins work - order: Z=A1, Y=A2, X=A3</li>
                    <li><strong>Pin 7 (LED):</strong> Any digital pin - simple on/off alert</li>
                    <li><strong>5V Power:</strong> GY-61 requires 3-5V, works fine with Arduino 5V</li>
                </ul>
            </div>
        </div>

        <div class="content-section">
            <h2>Complete Arduino Code</h2>

            <div class="code-container">
                <div class="code-header"><span class="code-lang">Arduino C++</span><span>Multi-Axis Sensor Processing</span></div>
                <pre><code>// ============================================
// CIRCUIT 05: GY-61 ACCELEROMETER + LED
// 3-Axis Motion Detection with G-Force Alert
// ============================================

// ===== PIN DEFINITIONS =====
const int xPin = A3;   // X-axis output of GY-61 connected to A3
const int yPin = A2;   // Y-axis output of GY-61 connected to A2
const int zPin = A1;   // Z-axis output of GY-61 connected to A1
const int ledPin = 7;  // LED connected to digital pin 7 (via 220Œ© resistor)

// ===== GLOBAL VARIABLES =====
int xRaw = 0;          // Raw X-axis reading (0-1023)
int yRaw = 0;          // Raw Y-axis reading (0-1023)
int zRaw = 0;          // Raw Z-axis reading (0-1023)

float xG = 0.0;        // X-axis acceleration in g-forces
float yG = 0.0;        // Y-axis acceleration in g-forces
float zG = 0.0;        // Z-axis acceleration in g-forces

// ===== CALIBRATION CONSTANTS =====
// GY-61 (ADXL335) outputs 1.65V (‚âà338 in analogRead) at 0g
// Sensitivity: ¬±300mV per g (‚âà61 per g in analogRead units)
const int ZERO_G = 338;     // analogRead value at 0g (1.65V at 5V reference)
const float SENSITIVITY = 61.0;  // analogRead units per g

// ===== THRESHOLD CONSTANT =====
const float G_THRESHOLD = 1.5;   // LED ON when any axis exceeds ¬±1.5g


// ===== SETUP FUNCTION =====
void setup() {
  // Initialize Serial communication at 9600 baud
  Serial.begin(9600);

  // Configure LED pin as output
  pinMode(ledPin, OUTPUT);

  // Initial LED state: OFF
  digitalWrite(ledPin, LOW);

  // Startup message
  Serial.println("===== GY-61 Accelerometer + LED =====");
  Serial.println("Monitoring 3-axis acceleration");
  Serial.println("LED ON when |g| > 1.5 on any axis");
  Serial.println("Open Serial Plotter for graph!");
  Serial.println("====================================");
  Serial.println();
  delay(1000);  // Brief pause before measurements start
}


// ===== MAIN LOOP =====
void loop() {

  // ===== STEP 1: Read raw values from all 3 axes =====
  xRaw = analogRead(xPin);  // Read X-axis (0-1023)
  yRaw = analogRead(yPin);  // Read Y-axis (0-1023)
  zRaw = analogRead(zPin);  // Read Z-axis (0-1023)


  // ===== STEP 2: Convert raw values to g-forces =====
  // Formula: g = (raw - zero_g) / sensitivity
  // Explanation:
  // - Subtract ZERO_G to center around 0
  // - Divide by SENSITIVITY to convert to g units
  xG = (xRaw - ZERO_G) / SENSITIVITY;
  yG = (yRaw - ZERO_G) / SENSITIVITY;
  zG = (zRaw - ZERO_G) / SENSITIVITY;


  // ===== STEP 3: Check for excessive motion on ANY axis =====
  // abs() returns absolute value (always positive)
  // This checks for motion in BOTH positive and negative directions
  // Example: abs(-2.0) = 2.0, abs(+2.0) = 2.0
  bool excessiveMotion = (abs(xG) > G_THRESHOLD) ||
                         (abs(yG) > G_THRESHOLD) ||
                         (abs(zG) > G_THRESHOLD);


  // ===== STEP 4: Control LED based on motion detection =====
  if (excessiveMotion) {
    // Motion exceeds threshold ‚Üí Turn LED ON
    digitalWrite(ledPin, HIGH);
  } else {
    // Normal motion ‚Üí Turn LED OFF
    digitalWrite(ledPin, LOW);
  }


  // ===== STEP 5: Output for Serial Monitor and Serial Plotter =====
  // Serial Plotter expects: value1, value2, value3 format
  // Each value will be a separate line on the graph
  Serial.print("X:");
  Serial.print(xG, 2);  // Print with 2 decimal places
  Serial.print("g,");   // Comma separator

  Serial.print("Y:");
  Serial.print(yG, 2);
  Serial.print("g,");

  Serial.print("Z:");
  Serial.print(zG, 2);
  Serial.println("g");  // println at end creates new line

  // Optional: Print LED status (comment out when using Serial Plotter)
  // if (excessiveMotion) {
  //   Serial.println(" [ALERT: Excessive motion!]");
  // }


  // ===== STEP 6: Small delay for stability =====
  delay(100);  // 100ms = 10 readings per second
               // Good balance between responsiveness and Serial output speed
}


// ===== END OF CODE =====
// Expected behavior:
// 1. At rest: X‚âà0g, Y‚âà0g, Z‚âà1g (gravity), LED OFF
// 2. Move/shake sensor: Values change, LED ON when any axis > ¬±1.5g
// 3. Serial Plotter: Open Tools ‚Üí Serial Plotter to see real-time graph
// 4. Serial Monitor: See numerical g-force values</code></pre>
            </div>
        </div>

        <div class="content-section">
            <h2>How It Works - Complete Breakdown</h2>

            <h3>1. Accelerometer Physics:</h3>
            <ul>
                <li><strong>At rest (lying flat):</strong> Z-axis reads ~1g (Earth's gravity pulling down), X and Y read ~0g</li>
                <li><strong>Tilted:</strong> Gravity component distributed across axes</li>
                <li><strong>Accelerating:</strong> Additional g-forces add to gravity reading</li>
                <li><strong>Free fall:</strong> All axes read ~0g (no contact force)</li>
            </ul>

            <h3>2. Analog to G-Force Conversion:</h3>
            <div class="formula">
                <div class="formula-label">Conversion formula:</div>
                <div class="formula-code">g = (analogRead - 338) / 61</div>
                <div class="formula-example">Example: Raw value 399 ‚Üí (399-338)/61 = 1.0g</div>
            </div>

            <p><strong>Why these numbers?</strong></p>
            <ul>
                <li><strong>338 = Zero point:</strong> GY-61 outputs 1.65V at 0g. At 5V reference: 1.65/5 √ó 1023 ‚âà 338</li>
                <li><strong>61 = Sensitivity:</strong> ¬±300mV per g. At 5V reference: 0.3/5 √ó 1023 ‚âà 61</li>
            </ul>

            <h3>3. abs() Function Usage:</h3>
            <div class="tip-box">
                <div class="box-title">Why abs() is Critical Here</div>
                <p><strong>Problem:</strong> Motion can be positive (+2g) or negative (-2g) on same axis</p>
                <p><strong>Solution:</strong> abs() converts to absolute value (always positive)</p>
                <p><strong>Examples:</strong></p>
                <ul>
                    <li>abs(1.8) = 1.8 ‚Üí Exceeds 1.5 threshold ‚úì</li>
                    <li>abs(-1.8) = 1.8 ‚Üí Exceeds 1.5 threshold ‚úì</li>
                    <li>abs(0.8) = 0.8 ‚Üí Below threshold ‚úó</li>
                    <li>abs(-0.8) = 0.8 ‚Üí Below threshold ‚úó</li>
                </ul>
            </div>

            <h3>4. Serial Plotter Format:</h3>
            <p>Format: <code>Label:Value,Label:Value,Label:Value</code></p>
            <ul>
                <li>Creates separate line for each labeled value</li>
                <li>X, Y, Z axes each get their own color</li>
                <li>Opens: Tools ‚Üí Serial Plotter in Arduino IDE</li>
                <li>Real-time graphing - great for debugging motion sensors</li>
            </ul>
        </div>

        <div class="content-section">
            <h2>Key Formulas & Concepts</h2>

            <div class="formula">
                <div class="formula-label">G-Force Conversion:</div>
                <div class="formula-code">g_force = (raw_value - ZERO_G) / SENSITIVITY</div>
                <div class="formula-example">ZERO_G=338, SENSITIVITY=61</div>
            </div>

            <div class="formula">
                <div class="formula-label">Absolute Value Check:</div>
                <div class="formula-code">if (abs(xG) > 1.5) { /* motion detected */ }</div>
                <div class="formula-example">Catches both +1.5g and -1.5g</div>
            </div>

            <div class="formula">
                <div class="formula-label">Multiple Condition Check:</div>
                <div class="formula-code">bool alert = (abs(xG)>1.5) || (abs(yG)>1.5) || (abs(zG)>1.5);</div>
                <div class="formula-example">|| means OR - any axis triggers alert</div>
            </div>

            <div class="formula">
                <div class="formula-label">Voltage to analogRead:</div>
                <div class="formula-code">analogRead_value = (voltage / 5.0) √ó 1023</div>
                <div class="formula-example">1.65V ‚Üí (1.65/5) √ó 1023 ‚âà 338</div>
            </div>
        </div>

        <div class="content-section">
            <h2>Common Mistakes</h2>
            <div class="warning-box">
                <div class="box-title">Code Errors:</div>
                <ul>
                    <li>‚ùå <strong>Forgetting abs():</strong> Only detects motion in one direction</li>
                    <li>‚ùå <strong>Wrong sensitivity value:</strong> Inaccurate g-force readings</li>
                    <li>‚ùå <strong>Using && instead of ||:</strong> Would require ALL axes > 1.5g (unlikely)</li>
                    <li>‚ùå <strong>Integer division:</strong> Use <code>61.0</code> not <code>61</code> for float result</li>
                    <li>‚ùå <strong>Wrong Serial Plotter format:</strong> Must end with println(), use commas between values</li>
                </ul>
            </div>

            <div class="warning-box">
                <div class="box-title">Wiring Errors:</div>
                <ul>
                    <li>‚ùå <strong>GY-61 on 3.3V:</strong> Works but changes calibration values</li>
                    <li>‚ùå <strong>Swapped X/Y/Z pins:</strong> Axes won't match physical movement</li>
                    <li>‚ùå <strong>No GND connection:</strong> Erratic readings</li>
                </ul>
            </div>
        </div>

        <div class="content-section">
            <h2>Exam Variations</h2>
            <div class="tip-box">
                <div class="box-title">Possible Modifications:</div>
                <ul>
                    <li>üîÑ <strong>Different threshold:</strong> "LED ON when > ¬±2.0g" instead of 1.5g</li>
                    <li>üîÑ <strong>Single axis only:</strong> "Monitor only Z-axis for vertical motion"</li>
                    <li>üîÑ <strong>All axes simultaneously:</strong> "LED ON only when ALL 3 axes > 1g" (use && instead of ||)</li>
                    <li>üîÑ <strong>Buzzer instead of LED:</strong> Same logic, different output</li>
                    <li>üîÑ <strong>No Serial output:</strong> Just LED indicator</li>
                    <li>üîÑ <strong>Range detection:</strong> "LED ON when 0.5g < motion < 2.0g"</li>
                </ul>
            </div>

            <h3>Quick Adaptations:</h3>
            <div class="formula">
                <div class="formula-label">Different threshold:</div>
                <div class="formula-code">const float G_THRESHOLD = 2.0;  // Change this value</div>
            </div>

            <div class="formula">
                <div class="formula-label">Single axis (Z only):</div>
                <div class="formula-code">bool excessiveMotion = (abs(zG) > G_THRESHOLD);</div>
            </div>

            <div class="formula">
                <div class="formula-label">All axes must exceed threshold (AND logic):</div>
                <div class="formula-code">bool alert = (abs(xG)>1.5) && (abs(yG)>1.5) && (abs(zG)>1.5);</div>
            </div>
        </div>

        <div class="content-section">
            <h2>Testing Checklist</h2>
            <ol>
                <li>‚úÖ Code compiles without errors</li>
                <li>‚úÖ Serial Monitor shows X, Y, Z values in g-forces</li>
                <li>‚úÖ At rest (flat): X‚âà0g, Y‚âà0g, Z‚âà1g</li>
                <li>‚úÖ Tilt sensor: Values change appropriately</li>
                <li>‚úÖ Shake sensor: LED turns ON when motion > 1.5g</li>
                <li>‚úÖ Serial Plotter displays 3 lines (X, Y, Z)</li>
                <li>‚úÖ abs() used for bidirectional detection</li>
                <li>‚úÖ Comments explain g-force conversion formula</li>
            </ol>
        </div>

        <div class="content-section">
            <h2>Quick Reference Summary</h2>
            <table>
                <thead><tr><th>Item</th><th>Value</th></tr></thead>
                <tbody>
                    <tr><td><strong>X-Axis Pin</strong></td><td>Analog A3</td></tr>
                    <tr><td><strong>Y-Axis Pin</strong></td><td>Analog A2</td></tr>
                    <tr><td><strong>Z-Axis Pin</strong></td><td>Analog A1</td></tr>
                    <tr><td><strong>LED Pin</strong></td><td>Digital 7 (with 220Œ©)</td></tr>
                    <tr><td><strong>Zero G Value</strong></td><td>338 (analogRead at 0g)</td></tr>
                    <tr><td><strong>Sensitivity</strong></td><td>61 units per g</td></tr>
                    <tr><td><strong>G Threshold</strong></td><td>¬±1.5g</td></tr>
                    <tr><td><strong>Key Function</strong></td><td>abs() for absolute value</td></tr>
                    <tr><td><strong>Formula</strong></td><td>(raw - 338) / 61 = g</td></tr>
                </tbody>
            </table>
        </div>

    </main>

    <footer>
        <p><a href="circuit-04-force-sensor-led.html">‚Üê Previous: Circuit 04</a> | <a href="index.html">Back to List</a> | <a href="circuit-06-pot-servo.html">Next: Circuit 06 ‚Üí</a></p>
    </footer>
</body>
</html>